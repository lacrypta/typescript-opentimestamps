// typescript-opentimestamps: An OpenTimestamps client written in TypeScript.
// Copyright (C) 2024  La Crypta
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU Affero General Public License as published
// by the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Affero General Public License for more details.
//
// You should have received a copy of the GNU Affero General Public License
// along with this program.  If not, see <https://www.gnu.org/licenses/>.

import { info } from '../../src/info';
import { read } from '../../src/read';
import { uint8ArrayFromBase64 } from '../../src/utils';

const badStamp: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEIfjcXu+Ag9TzcbEAVShqOVb3cE6KMi7PILp7mS4G0SHID8cgBAQAAAAHkgvnTLsw7ple2nYmAEIV7VEV6kEl5gv9W+XxOxY5vmAEAAABrSDBFAiEAslOt0dHPkIRDOKR1oE/xP8nnvSQrB3Yt6gf1YIst42cCIACyaMqcM0KzdpzdBiiRMXzc74eqwxC2hV6dk4mOu+jsASECDY5NEH0rM5sAUO/dS0oJJFqgVgSPElOWN06moqsHCcb/////AmUz5gUAAAAAGXapFAvwV9QPu6Z0SGJRX1tVojEN5XcviKyghgEAAAAAABl2qRTwBoisAAAAAAgI8SCph/cWxTORPDFMeONdNYhMrJQ/pCysSdKyxp9AA/hfiAgI8SDexVs0h+Hj9yKkm1WneDIVhieF9KOss5KEYBn3HcZKnQgI8SCyyhj0heCAR44CXas9RktBbA4ey2Ypya786MghTQQkMggI8CARsOkGYRlv9LCBPD7aFBurXpFgSDe996DJ3zfbDjoRmAgI8CDDS8GkoQk//RSMAWseZkdCkU6Tnvq+TT01ZRWRSybZ4ggI8CDD5ufDjGn2ryTCvjTrrEglft5h7AohuVNeREMne+MGRggI8SAHmL+GBuAAJOXV1UvwyWD2Kd+52taRV0VbbyZSwOjegQgI8CA/mtptYLqiRABrsKrVFEitL6+51LZIegmZz/JrkfD1NggI8SDHAwGelZqN0/rvdIm7MoukhVdHWOcJHwFGTrZYcsl1yAgI8CDL/v/1E/+EuRXj/tb515lnZjD4Nk6ipsdVf62UpbXXiAgI8SAL4jcJhZkTur1EYLvd+O0hPnyHc6Sx+s4w+Kz98JO3BQgIAAWIlg1z1xkBA/fvFQ==`,
);
const badStampInfo: string = `# version: 1
msg = sha256(FILE)
    = 7e3717bbe020f53cdc6c40154a1a8e55bddc13a28c8bb3c82e9ee64b81b44872
msg = ripemd160(msg)
    = 00639b71724c130822a9f0e3660262c2057406e3
msg = prepend(msg, 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a914)
    = 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a91400639b71724c130822a9f0e3660262c2057406e3
msg = append(msg, 88ac00000000)
    = 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a91400639b71724c130822a9f0e3660262c2057406e388ac00000000
msg = sha256(msg)
    = e6056f0106a46800c0bfaa1b2fb053c355a5db8b76c4dd2265ff4acf279c9a64
msg = sha256(msg)
    = 69dbe0c585a89fb0b4c7076fb52f5182717730b26b8257e9e33ea29ff3e3f502
msg = prepend(msg, a987f716c533913c314c78e35d35884cac943fa42cac49d2b2c69f4003f85f88)
    = a987f716c533913c314c78e35d35884cac943fa42cac49d2b2c69f4003f85f8869dbe0c585a89fb0b4c7076fb52f5182717730b26b8257e9e33ea29ff3e3f502
msg = sha256(msg)
    = 527c7354bf01e3f8a8bfbf657bb38e4f4fc243fcfcf4e5d19debbe30fa5fc8dc
msg = sha256(msg)
    = 598f03d410d5e9971348f5574384364af5bc46120aeb1a19f07d42f854163b84
msg = prepend(msg, dec55b3487e1e3f722a49b55a7783215862785f4a3acb392846019f71dc64a9d)
    = dec55b3487e1e3f722a49b55a7783215862785f4a3acb392846019f71dc64a9d598f03d410d5e9971348f5574384364af5bc46120aeb1a19f07d42f854163b84
msg = sha256(msg)
    = 823770d66f4ccb4313dcfe76086145cbeb7238895ecf8f09164cc7feae8d71e5
msg = sha256(msg)
    = b9f810c2a64fc738769cacb3436d671aa68adc0c406e4f95f7bd3e5e1fd6a089
msg = prepend(msg, b2ca18f485e080478e025dab3d464b416c0e1ecb6629c9aefce8c8214d042432)
    = b2ca18f485e080478e025dab3d464b416c0e1ecb6629c9aefce8c8214d042432b9f810c2a64fc738769cacb3436d671aa68adc0c406e4f95f7bd3e5e1fd6a089
msg = sha256(msg)
    = 6a34f352a6b8909c217bfbb8b0f6195e74f1dfc332d72ff2fb343ce18329f6ad
msg = sha256(msg)
    = 8cdff66808b6237f855a517a1aa175eeab40c56f4f029eca6c648e7e66ad183e
msg = append(msg, 11b0e90661196ff4b0813c3eda141bab5e91604837bdf7a0c9df37db0e3a1198)
    = 8cdff66808b6237f855a517a1aa175eeab40c56f4f029eca6c648e7e66ad183e11b0e90661196ff4b0813c3eda141bab5e91604837bdf7a0c9df37db0e3a1198
msg = sha256(msg)
    = dd5557fd745118fd39e4743cb674e4db57bce1a477473139d2e280f34283eed8
msg = sha256(msg)
    = dc863f793bc57baf930e4e60ef2ebf76b582fee122ac334c5d52e4c5bf04f414
msg = append(msg, c34bc1a4a1093ffd148c016b1e664742914e939efabe4d3d356515914b26d9e2)
    = dc863f793bc57baf930e4e60ef2ebf76b582fee122ac334c5d52e4c5bf04f414c34bc1a4a1093ffd148c016b1e664742914e939efabe4d3d356515914b26d9e2
msg = sha256(msg)
    = dbbae5a30e7909a585fd3f45fe02c4e5e7882ddc2c71fd1c667a9e1b85a942f5
msg = sha256(msg)
    = 448b1721d54f65255f05036519803f20a731b7bee8028969f8527c72ebf53faa
msg = append(msg, c3e6e7c38c69f6af24c2be34ebac48257ede61ec0a21b9535e4443277be30646)
    = 448b1721d54f65255f05036519803f20a731b7bee8028969f8527c72ebf53faac3e6e7c38c69f6af24c2be34ebac48257ede61ec0a21b9535e4443277be30646
msg = sha256(msg)
    = 852fa9f4da1a595f0a08c840b6dcd05082009ba773eef5d398caf902c65efa55
msg = sha256(msg)
    = 2d1b4acf33733db7fa73526841c62cc1f81a6e97ea5bf016ae4ca2ec47799e57
msg = prepend(msg, 0798bf8606e00024e5d5d54bf0c960f629dfb9dad69157455b6f2652c0e8de81)
    = 0798bf8606e00024e5d5d54bf0c960f629dfb9dad69157455b6f2652c0e8de812d1b4acf33733db7fa73526841c62cc1f81a6e97ea5bf016ae4ca2ec47799e57
msg = sha256(msg)
    = 0083ab9498294d4408c8834b365064b114d8f0a5b97433a0ec92d75106057ef0
msg = sha256(msg)
    = ab382bdbf6006cb360220b0dcf50757a86edfe436d2dadf1fe5372534a9c18b2
msg = append(msg, 3f9ada6d60baa244006bb0aad51448ad2fafb9d4b6487a0999cff26b91f0f536)
    = ab382bdbf6006cb360220b0dcf50757a86edfe436d2dadf1fe5372534a9c18b23f9ada6d60baa244006bb0aad51448ad2fafb9d4b6487a0999cff26b91f0f536
msg = sha256(msg)
    = 9780b3f89f63b4c818f1d7393a2c071c0e1a340c53bdc02104f55d32d786c1a2
msg = sha256(msg)
    = 674696d5b8361b8a6857e9baddb9a2af40711a2ffef658750c27fffb949d3e98
msg = prepend(msg, c703019e959a8dd3faef7489bb328ba485574758e7091f01464eb65872c975c8)
    = c703019e959a8dd3faef7489bb328ba485574758e7091f01464eb65872c975c8674696d5b8361b8a6857e9baddb9a2af40711a2ffef658750c27fffb949d3e98
msg = sha256(msg)
    = 837d1c47efe10a43546898b92cd1a180dc190093e23e5eaa254d5c464c2c0b0f
msg = sha256(msg)
    = a1764e47b46eff51513f2d1dbfc7a4446e5faf68922fd441d593babfa19b09ad
msg = append(msg, cbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788)
    = a1764e47b46eff51513f2d1dbfc7a4446e5faf68922fd441d593babfa19b09adcbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788
msg = sha256(msg)
    = fa3d036255f9e9dff69b09f8dd5036d95c855bb740e8802f8bfc15661663e16d
msg = sha256(msg)
    = 8753af25c5c891d14dec0f5a5fef78ff33995a8b29d8025b1c716561f5c96678
msg = prepend(msg, 0be23709859913babd4460bbddf8ed213e7c8773a4b1face30f8acfdf093b705)
    = 0be23709859913babd4460bbddf8ed213e7c8773a4b1face30f8acfdf093b7058753af25c5c891d14dec0f5a5fef78ff33995a8b29d8025b1c716561f5c96678
msg = sha256(msg)
    = c05782882fd102c364c90401ca9a538684ce937c68ca045d5714514888029821
msg = sha256(msg)
    = 921f81b9147c9aebe712d7805d810cf0f762479967e4c26008178277b89db41b
bitcoinVerify(msg, 358391)`;

const empty: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEI47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFUD8egaAQAAABMFYazJwbXc/UKJ7qGPLiDLM9xDwqiVoRzaEjvfV5GZmQAAAACMSTBGAiEApBD6Cw490P1DOjo+iH7OZLOlWcrCMl6pvyctZlopAdICIQC0Jf/vEP0CaIalBJIHet7j2trk7MGP9xwc0F0djRJ8wgFBBEHCPOq2+SdB8KM9eQrB8D/ZHH9Kr23R0O3aNHUc6Cz1IvRdy/+4ZbIIQUCzGaPxhPbeOrDFwuXzLFqvNt24Y6L/////QKX3uI5ciKOWFsNRmHSzn18SBkJ8rb0KaDlvQedWPCcAAAAAi0gwRQIhAKG2P0Gv8PF4PwEl1qouDmeAR+oaVx5ieSb8FiMAckWkAiAFDB3Odk2a5djkdNtZwYrmm8PJ/APIaHnSef+b+xlPygFBBKNQMov0yC3ezhdPY89OmoiD44Iq94Kb0h9ZtCNGTwISgKaZfUCzGecnyOEzk83KZtADft8FWKc2Cy+L+D8ABJD/////SyCmHRPilFPC/2PHk1cy9FIfHuDIadwWe2VWsut4rZgAAAAAikcwRAIgXizFPt/SdOpLLKRlciUGYAhxjh1NlPwwvtISHhZjOPUCIAjP/1mDikB958S/Srjst9fpCgBFZFk49uWkolrNFu8nAUEEyFEnntSvdyjTFDLMuu7c3Fpq9VZkcxZ753oAiLp4rJusPYLJ/3mOjV4yv8+nscTEuxyDB4dEn02YkHJDww6rj/////9h94plT3NzR066fGue8SNzoT6YeX1G0pgdz1/Q7EnB+wEAAACKRzBEAiB61NautfPZaw/Vz+SkKy1tNRi9lEUjpAb71HrWmVQSkgIgJA7zxFpFGj/k15WR15C7sLwV28yXUN+Uk/Ci2K0eVx4BQQQtqDTfFofSX0ftTAqOEcjmh1N679ggfBVmwuXxAwCxZsVlOlMzA05wYHfP0Jjr+Pt14DVM5nuzjApcZxBt1M54/////3P2qwQAaNWaWM4JcBj5MNQvsSM8ImHp5AfHWbxRekYsAAAAAItIMEUCIG2lprEKq+HJQU689cNaBzmo0zs4Lnn057D0CO465ohEAiEAqxIkIrKEMNQSxjTwia7LKQM2DL8049/c5il2rY7uBVIBQQQgYu0kv1VctDdpfJEZNW8wy1STu9hN0z2ebpuEctqZkLvc0FLHAy99LFe66uJwQc8ihJyL21cC693B6XD5Ksc4/////3eyR1CVvWtV/ro4gOwSeSnG1jLC6PVqxv0qL8nZZ86fAQAAAIpHMEQCIFv6okhsKvpRc1znawHN+BA5uRLUsbmmwVPWJg2CzRZ+AiAmybgZeXlvI1z1tc38avt+HYV+nalZ59/qzPHaGLlagAFBBJmWjmJetL6luQHEKg7PtlX2Z6+vbv64G4waqC0fZLjuMRH1t5Ae2DxDxQ6YwFlsNaai2YbRLsUXIIJJbRuKl6T/////epc0MOROoBrovyzJ5pNQLmhctM0t/iAI89m42mTKU88AAAAAi0gwRQIgdUTe8uoYqsFOOmeTzC5vxcIx8SEDNot+m3+UGjC3OBECIQCPFZFzdp+vPINrmJQmoOaCnZP17g+dDUjsDbod9MegrwFBBCE1ODEe3mDSAR5Q1TxjU/qlDZfsKlp2kExmsCgOUB6SY+yCCczoPzi1Q8c7bbJsCK5yyWHP3A5gWvsu6Si33R3/////fMplVDL/rDTvSODDMZEqAHC5Hd7wCZO15V0aZ2rZFS4AAAAAi0gwRQIhANOw1FaSshu0KHEzW9SKmEIZZci6ZSr3Sn+nbDLmjKz8AiB8nCqlBYpl5b0T4aBPe79Ix7O3zON5LqqPu3b7pp2g2QFBBAJJiO5ETUcuf/AaR86kczyKAVDLNb+hXT9/tbYE1pFB5q+b779fRJ/UYaHgESce3maeHF4Hde9Xw8Y8EUUZ3RT/////htBo4tOTr0MoeP4wDHuRNa2sDoZm4a1NgqU8Kx1kBxgBAAAAi0gwRQIgPsrBlUlWtCyYzOU4UZYhV/iTlkFIFS+W41JsBkBLRfcCIQD5/mKcBnWYMrG+zLSVQKaM4bhNaPWm11/yfkpmFTo4CQFBBHuycCdtmshSH9XjMhFyQ4J05+W7nuCMLEt+CaGk2rQ6zjPn0D1qJQcWrjxAeqKHUi1xbLpNo/PKcvj2Xg5kA7H/////iOfaEaFyGr58/uOHUklBSCJzglXlNJpA7Mhg9+UyCxABAAAAjEkwRgIhAKenXiwLRTO5IethROcbxUv+EOzIy3QEDuqEvseyi3wkAiEA3v1qqNlhICHHXXCZncu3nBwkVnC/otEG2V/+SHDBOicBQQRVdNDjXL6B9uripEXMdZGIibHo7Ui2lqtxMXL1yKnrevPj93xBBpJamatDLNV1jXaczyI6LEpTzMsWJZhCdrfu/////8TYorsxMfZZC2TU0ZHaBLJpcpZhG2fCKfeIBLfOrKK3AQAAAIpHMEQCICq8scKIIf1MOw4lfhgWho7MvTQYgMpxZzFg18AOek2hAiAYWLujJpe9AN+WGwgpLDFTcFORVcSZfNM1BQDuClSF9AFBBLHWTtsgJN+SKrU8czVmfREbGR21k5brp6BbCx5F8wyKToLCqsT4/FNcyBY8meLZASuqwIvk05JmcX2FPPVorrL/////xdxOdnznW7zLfStMkD2sN8Tz/oRr4VD7W3DLQghx8wQAAAAAi0gwRQIgE/OerjEEPbNzPyKHbflDkxnneVo3h//7VkQCARwX1RsCIQCJyg1HqnNOaperWtbXjm34rKMAbhjIFO7sk1pla3iLQgFBBIyhCx+W6pEht5La0nMUxPLX0UPCfWd6eL1KkqK54PANTBOZML3ZYbyFczbOYRKsALCLq7aDlxkCqkRkFS3wsBr/////1j4uX9vSsjwJKKyADukv6dCwySlLSugFiuJX2+2OX74BAAAAikcwRAIgdfs85KJitQp6zFMAhWTgvYw+i3zBrqOnbWJxqjaHjBcCICoqlcyvYGBTGbdqtQKhG+L1or1rBMpKiO3i0oz+3DlHAUEEvBJ9p8Q9to/5Yp8O8D/Ih3YZK9V6GmEnbeh+3ORboPpvmV+tMNqYoRfjalaOo1c8YkyEJaZqImqCUOWl6RSviP/////nrHXs1rV4p33cjSDZIzBcrQJceFenbyNXSBAeafV95AAAAACKRzBEAiBy4JYoTJIAuYsqKdk73P7B/rccAfJEsX3TcY38e0T/oAIgeErl33X9YhdZbrYmWeLhy+MPQfh9rDdZ5ciVqqP4IiwBQQT1+OAH7BJFAy2HTKxaa0fGZ3CuwudSSdNYKPLeHiw0CF2RI+DN2lCTE0Ly4+e6MpIJwefxUif7f+LYg5bMH/So/////+1jZRQIBrdrPGO49OCPaAvRB5MRr9hfNJGd4IXqBvJuAQAAAItIMEUCIG/YFiE1m3/cxjCxr/XDuZZJYptb8iByHfTxNpKUPUsjAiEA/sOwvHsVZkaIgyA/wiU1fFznod6hR2XlIFx7R/inTGsBQQSioU0xsJ+fCSkj42nnwXi5oKLBiCPgJUZMNrkxbMWE4e1qV2NsRt/WBqB3Red4Ln6cpm3FuUqhi1fisLdlt8YO/////xdCijUDPVTNyS2fQ8dKEK712c4TT8IBkv7KuNYsYFPeAAAAAItIMEUCID9ahXCL46vri7ZcPLUrJSUsfmORG4TFro14nlk03FtaAiEAoxQarql+gAqRvmv4Ou67y2GPwkwHb9pmsfevLGj+fDwBQQRXES2+DBY6igGhB8kewBdNBcY97E5u1XzK9A9K5dIzlwdI+XRIUPCQa7ls+pSLreBuSUw7PJDlCIb+mUME1fgJ/////13gR6LA4y/nSK2XPkFc/PryjA/ES6IYba4RMpc75L1YAQAAAIpHMEQCID/aw+L2n8ms0Sxi9VF2yljItpPpr9qY1k8Jd+WlQJoqAiBS4zfW0ov4xw7Ld8lS8yMKFGu/jOkyY2rzXTQvtK8dQgFBBBiS+vApXZsRedzE9r4u4oIrVRv0X+qFeXDoN04iOHwykxQziTsdOcTa3+OHKc9PcWAPMSRZwiTw1KSSL6K0zjv/////pg14gRpuZcd6DByCT9kediPbXqxFhxtelDxRMasqhOEBAAAAikcwRAIgGVkqqQ0Bg50dCVBzAjujjhDKZnC+mFpyZBrx9FBJNzwCIAn0PULYIwplVWKBG8Ix2wJYG9l2mxmkJ6KCxCFnl+mhAUEEyd+V3Mgz7ZuHZ+7LbbKWKo56T+/Qsy8tD4DRRqnbLfSscDWjByBFOHf6rFdPT3lCKV7F8tsA249cexxPklpgyv////+VR8nOKCDLcTDRgNsI2JvHdaEaQBgpl0hsvabGdZjucgEAAACLSDBFAiEA7SELqub7CQcA5eto/59PsNozBG9arSbJqH1pGn3F3OACIBzashKEapjJ54NiBCRwIEuOu5sbF8iubK0g0tU55PRMAUEEqnps4DuX2GpvPSyf1ocZQPeYe2rlwZDcMk5uApI9ZoETQRaji/jRRq1L5WSuGGtcCWx8Mbp7hO9QKVqrVU4Qwv////8BwBSXFgAAAAAZdqkU8AaIrAAAAAAICPEg24uKv2U7iwH7y334XlGi3LivakuRSgwKoeIFaXgqOUIICPEgxEA+xSiDFCSCf/sx12aav5cZXNPV3HZs7HEyUyrLIlIICPAgfciQE17liPbx4kbagSyOtTGcj7QM63tGRyw2XEMYL94ICPEggUbGpSkvyMGiMjOe6cMOQLOg7ptu/4r9M3nG3JPQjdsICPEgen7hqmqmd75Gil2zsEzcE2qS/nyw5S6lcZzCyAZpzNQICPEgsZnTs+nAI0p8g/XkMalmigx2WLGkk0257AnZ6gzSVA4ICPAgvuEjgt1vkgr06hRbEUzyxFFQbY70yblk/taVoJk5U1EICPAgN+/NaXK3nt3aUZH/fcJfYdRJY97xUpr1X/j9iTpHDBwICAAFiJYNc9cZAQP98gc=`,
);
const emptyInfo: string = `# version: 1
msg = sha256(FILE)
    = e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
msg = ripemd160(msg)
    = b472a266d0bd89c13706a4132ccfb16f7c3b9fcb
msg = prepend(msg, 01000000130561acc9c1b5dcfd4289eea18f2e20cb33dc43c2a895a11cda123bdf57919999000000008c493046022100a410fa0b0e3dd0fd433a3a3e887ece64b3a559cac2325ea9bf272d665a2901d2022100b425ffef10fd026886a50492077adee3dadae4ecc18ff71c1cd05d1d8d127cc201410441c23ceab6f92741f0a33d790ac1f03fd91c7f4aaf6dd1d0edda34751ce82cf522f45dcbffb865b2084140b319a3f184f6de3ab0c5c2e5f32c5aaf36ddb863a2ffffffff40a5f7b88e5c88a39616c3519874b39f5f1206427cadbd0a68396f41e7563c27000000008b483045022100a1b63f41aff0f1783f0125d6aa2e0e678047ea1a571e627926fc1623007245a40220050c1dce764d9ae5d8e474db59c18ae69bc3c9fc03c86879d279ff9bfb194fca014104a350328bf4c82ddece174f63cf4e9a8883e3822af7829bd21f59b423464f021280a6997d40b319e727c8e13393cdca66d0037edf0558a7360b2f8bf83f000490ffffffff4b20a61d13e29453c2ff63c7935732f4521f1ee0c869dc167b6556b2eb78ad98000000008a47304402205e2cc53edfd274ea4b2ca4657225066008718e1d4d94fc30bed2121e166338f5022008cfff59838a407de7c4bf4ab8ecb7d7e90a0045645938f6e5a4a25acd16ef27014104c851279ed4af7728d31432ccbaeedcdc5a6af5566473167be77a0088ba78ac9bac3d82c9ff798e8d5e32bfcfa7b1c4c4bb1c830787449f4d98907243c30eab8fffffffff61f78a654f7373474eba7c6b9ef12373a13e98797d46d2981dcf5fd0ec49c1fb010000008a47304402207ad4d6aeb5f3d96b0fd5cfe4a42b2d6d3518bd944523a406fbd47ad6995412920220240ef3c45a451a3fe4d79591d790bbb0bc15dbcc9750df9493f0a2d8ad1e571e0141042da834df1687d25f47ed4c0a8e11c8e687537aefd8207c1566c2e5f10300b166c5653a5333034e706077cfd098ebf8fb75e0354ce67bb38c0a5c67106dd4ce78ffffffff73f6ab040068d59a58ce097018f930d42fb1233c2261e9e407c759bc517a462c000000008b48304502206da5a6b10aabe1c9414ebcf5c35a0739a8d33b382e79f4e7b0f408ee3ae68844022100ab122422b28430d412c634f089aecb2903360cbf34e3dfdce62976ad8eee05520141042062ed24bf555cb437697c9119356f30cb5493bbd84dd33d9e6e9b8472da9990bbdcd052c7032f7d2c57baeae27041cf22849c8bdb5702ebddc1e970f92ac738ffffffff77b2475095bd6b55feba3880ec127929c6d632c2e8f56ac6fd2a2fc9d967ce9f010000008a47304402205bfaa2486c2afa51735ce76b01cdf81039b912d4b1b9a6c153d6260d82cd167e022026c9b81979796f235cf5b5cdfc6afb7e1d857e9da959e7dfeaccf1da18b95a8001410499968e625eb4bea5b901c42a0ecfb655f667afaf6efeb81b8c1aa82d1f64b8ee3111f5b7901ed83c43c50e98c0596c35a6a2d986d12ec5172082496d1b8a97a4ffffffff7a973430e44ea01ae8bf2cc9e693502e685cb4cd2dfe2008f3d9b8da64ca53cf000000008b48304502207544def2ea18aac14e3a6793cc2e6fc5c231f12103368b7e9b7f941a30b738110221008f159173769faf3c836b989426a0e6829d93f5ee0f9d0d48ec0dba1df4c7a0af014104213538311ede60d2011e50d53c6353faa50d97ec2a5a76904c66b0280e501e9263ec8209cce83f38b543c73b6db26c08ae72c961cfdc0e605afb2ee928b7dd1dffffffff7cca655432ffac34ef48e0c331912a0070b91ddef00993b5e55d1a676ad9152e000000008b483045022100d3b0d45692b21bb42871335bd48a98421965c8ba652af74a7fa76c32e68cacfc02207c9c2aa5058a65e5bd13e1a04f7bbf48c7b3b7cce3792eaa8fbb76fba69da0d9014104024988ee444d472e7ff01a47cea4733c8a0150cb35bfa15d3f7fb5b604d69141e6af9befbf5f449fd461a1e011271ede669e1c5e0775ef57c3c63c114519dd14ffffffff86d068e2d393af432878fe300c7b9135adac0e8666e1ad4d82a53c2b1d640718010000008b48304502203ecac1954956b42c98cce53851962157f893964148152f96e3526c06404b45f7022100f9fe629c06759832b1beccb49540a68ce1b84d68f5a6d75ff27e4a66153a38090141047bb270276d9ac8521fd5e3321172438274e7e5bb9ee08c2c4b7e09a1a4dab43ace33e7d03d6a250716ae3c407aa287522d716cba4da3f3ca72f8f65e0e6403b1ffffffff88e7da11a1721abe7cfee3875249414822738255e5349a40ecc860f7e5320b10010000008c493046022100a7a75e2c0b4533b921eb6144e71bc54bfe10ecc8cb74040eea84bec7b28b7c24022100defd6aa8d9612021c75d70999dcbb79c1c245670bfa2d106d95ffe4870c13a270141045574d0e35cbe81f6eae2a445cc75918889b1e8ed48b696ab713172f5c8a9eb7af3e3f77c4106925a99ab432cd5758d769ccf223a2c4a53cccb1625984276b7eeffffffffc4d8a2bb3131f6590b64d4d191da04b2697296611b67c229f78804b7ceaca2b7010000008a47304402202abcb1c28821fd4c3b0e257e1816868eccbd341880ca71673160d7c00e7a4da102201858bba32697bd00df961b08292c315370539155c4997cd3350500ee0a5485f4014104b1d64edb2024df922ab53c7335667d111b191db59396eba7a05b0b1e45f30c8a4e82c2aac4f8fc535cc8163c99e2d9012baac08be4d39266717d853cf568aeb2ffffffffc5dc4e767ce75bbccb7d2b4c903dac37c4f3fe846be150fb5b70cb420871f304000000008b483045022013f39eae31043db3733f22876df9439319e7795a3787fffb564402011c17d51b02210089ca0d47aa734e6a97ab5ad6d78e6df8aca3006e18c814eeec935a656b788b420141048ca10b1f96ea9121b792dad27314c4f2d7d143c27d677a78bd4a92a2b9e0f00d4c139930bdd961bc857336ce6112ac00b08babb683971902aa4464152df0b01affffffffd63e2e5fdbd2b23c0928ac800ee92fe9d0b0c9294b4ae8058ae257dbed8e5fbe010000008a473044022075fb3ce4a262b50a7acc53008564e0bd8c3e8b7cc1aea3a76d6271aa36878c1702202a2a95ccaf60605319b76ab502a11be2f5a2bd6b04ca4a88ede2d28cfedc3947014104bc127da7c43db68ff9629f0ef03fc88776192bd57a1a61276de87edce45ba0fa6f995fad30da98a117e36a568ea3573c624c8425a66a226a8250e5a5e914af88ffffffffe7ac75ecd6b578a77ddc8d20d923305cad025c7857a76f235748101e69f57de4000000008a473044022072e096284c9200b98b2a29d93bdcfec1feb71c01f244b17dd3718dfc7b44ffa00220784ae5df75fd6217596eb62659e2e1cbe30f41f87dac3759e5c895aaa3f8222c014104f5f8e007ec1245032d874cac5a6b47c66770aec2e75249d35828f2de1e2c34085d9123e0cdda50931342f2e3e7ba329209c1e7f15227fb7fe2d88396cc1ff4a8ffffffffed6365140806b76b3c63b8f4e08f680bd1079311afd85f34919de085ea06f26e010000008b48304502206fd81621359b7fdcc630b1aff5c3b99649629b5bf220721df4f13692943d4b23022100fec3b0bc7b1566468883203fc225357c5ce7a1dea14765e5205c7b47f8a74c6b014104a2a14d31b09f9f092923e369e7c178b9a0a2c18823e025464c36b9316cc584e1ed6a57636c46dfd606a07745e7782e7e9ca66dc5b94aa18b57e2b0b765b7c60effffffff17428a35033d54cdc92d9f43c74a10aef5d9ce134fc20192fecab8d62c6053de000000008b48304502203f5a85708be3abeb8bb65c3cb52b25252c7e63911b84c5ae8d789e5934dc5b5a022100a3141aaea97e800a91be6bf83aeebbcb618fc24c076fda66b1f7af2c68fe7c3c01410457112dbe0c163a8a01a107c91ec0174d05c63dec4e6ed57ccaf40f4ae5d233970748f9744850f0906bb96cfa948bade06e494c3b3c90e50886fe994304d5f809ffffffff5de047a2c0e32fe748ad973e415cfcfaf28c0fc44ba2186dae1132973be4bd58010000008a47304402203fdac3e2f69fc9acd12c62f55176ca58c8b693e9afda98d64f0977e5a5409a2a022052e337d6d28bf8c70ecb77c952f3230a146bbf8ce932636af35d342fb4af1d420141041892faf0295d9b1179dcc4f6be2ee2822b551bf45fea857970e8374e22387c32931433893b1d39c4dadfe38729cf4f71600f312459c224f0d4a4922fa2b4ce3bffffffffa60d78811a6e65c77a0c1c824fd91e7623db5eac45871b5e943c5131ab2a84e1010000008a473044022019592aa90d01839d1d095073023ba38e10ca6670be985a72641af1f45049373c022009f43d42d8230a655562811bc231db02581bd9769b19a427a282c4216797e9a1014104c9df95dcc833ed9b8767eecb6db2962a8e7a4fefd0b32f2d0f80d146a9db2df4ac7035a30720453877faac574f4f7942295ec5f2db00db8f5c7b1c4f925a60caffffffff9547c9ce2820cb7130d180db08d89bc775a11a40182997486cbda6c67598ee72010000008b483045022100ed210baae6fb090700e5eb68ff9f4fb0da33046f5aad26c9a87d691a7dc5dce002201cdab212846a98c9e78362042470204b8ebb9b1b17c8ae6cad20d2d539e4f44c014104aa7a6ce03b97d86a6f3d2c9fd6871940f7987b6ae5c190dc324e6e02923d6681134116a38bf8d146ad4be564ae186b5c096c7c31ba7b84ef50295aab554e10c2ffffffff01c0149716000000001976a914)
    = 01000000130561acc9c1b5dcfd4289eea18f2e20cb33dc43c2a895a11cda123bdf57919999000000008c493046022100a410fa0b0e3dd0fd433a3a3e887ece64b3a559cac2325ea9bf272d665a2901d2022100b425ffef10fd026886a50492077adee3dadae4ecc18ff71c1cd05d1d8d127cc201410441c23ceab6f92741f0a33d790ac1f03fd91c7f4aaf6dd1d0edda34751ce82cf522f45dcbffb865b2084140b319a3f184f6de3ab0c5c2e5f32c5aaf36ddb863a2ffffffff40a5f7b88e5c88a39616c3519874b39f5f1206427cadbd0a68396f41e7563c27000000008b483045022100a1b63f41aff0f1783f0125d6aa2e0e678047ea1a571e627926fc1623007245a40220050c1dce764d9ae5d8e474db59c18ae69bc3c9fc03c86879d279ff9bfb194fca014104a350328bf4c82ddece174f63cf4e9a8883e3822af7829bd21f59b423464f021280a6997d40b319e727c8e13393cdca66d0037edf0558a7360b2f8bf83f000490ffffffff4b20a61d13e29453c2ff63c7935732f4521f1ee0c869dc167b6556b2eb78ad98000000008a47304402205e2cc53edfd274ea4b2ca4657225066008718e1d4d94fc30bed2121e166338f5022008cfff59838a407de7c4bf4ab8ecb7d7e90a0045645938f6e5a4a25acd16ef27014104c851279ed4af7728d31432ccbaeedcdc5a6af5566473167be77a0088ba78ac9bac3d82c9ff798e8d5e32bfcfa7b1c4c4bb1c830787449f4d98907243c30eab8fffffffff61f78a654f7373474eba7c6b9ef12373a13e98797d46d2981dcf5fd0ec49c1fb010000008a47304402207ad4d6aeb5f3d96b0fd5cfe4a42b2d6d3518bd944523a406fbd47ad6995412920220240ef3c45a451a3fe4d79591d790bbb0bc15dbcc9750df9493f0a2d8ad1e571e0141042da834df1687d25f47ed4c0a8e11c8e687537aefd8207c1566c2e5f10300b166c5653a5333034e706077cfd098ebf8fb75e0354ce67bb38c0a5c67106dd4ce78ffffffff73f6ab040068d59a58ce097018f930d42fb1233c2261e9e407c759bc517a462c000000008b48304502206da5a6b10aabe1c9414ebcf5c35a0739a8d33b382e79f4e7b0f408ee3ae68844022100ab122422b28430d412c634f089aecb2903360cbf34e3dfdce62976ad8eee05520141042062ed24bf555cb437697c9119356f30cb5493bbd84dd33d9e6e9b8472da9990bbdcd052c7032f7d2c57baeae27041cf22849c8bdb5702ebddc1e970f92ac738ffffffff77b2475095bd6b55feba3880ec127929c6d632c2e8f56ac6fd2a2fc9d967ce9f010000008a47304402205bfaa2486c2afa51735ce76b01cdf81039b912d4b1b9a6c153d6260d82cd167e022026c9b81979796f235cf5b5cdfc6afb7e1d857e9da959e7dfeaccf1da18b95a8001410499968e625eb4bea5b901c42a0ecfb655f667afaf6efeb81b8c1aa82d1f64b8ee3111f5b7901ed83c43c50e98c0596c35a6a2d986d12ec5172082496d1b8a97a4ffffffff7a973430e44ea01ae8bf2cc9e693502e685cb4cd2dfe2008f3d9b8da64ca53cf000000008b48304502207544def2ea18aac14e3a6793cc2e6fc5c231f12103368b7e9b7f941a30b738110221008f159173769faf3c836b989426a0e6829d93f5ee0f9d0d48ec0dba1df4c7a0af014104213538311ede60d2011e50d53c6353faa50d97ec2a5a76904c66b0280e501e9263ec8209cce83f38b543c73b6db26c08ae72c961cfdc0e605afb2ee928b7dd1dffffffff7cca655432ffac34ef48e0c331912a0070b91ddef00993b5e55d1a676ad9152e000000008b483045022100d3b0d45692b21bb42871335bd48a98421965c8ba652af74a7fa76c32e68cacfc02207c9c2aa5058a65e5bd13e1a04f7bbf48c7b3b7cce3792eaa8fbb76fba69da0d9014104024988ee444d472e7ff01a47cea4733c8a0150cb35bfa15d3f7fb5b604d69141e6af9befbf5f449fd461a1e011271ede669e1c5e0775ef57c3c63c114519dd14ffffffff86d068e2d393af432878fe300c7b9135adac0e8666e1ad4d82a53c2b1d640718010000008b48304502203ecac1954956b42c98cce53851962157f893964148152f96e3526c06404b45f7022100f9fe629c06759832b1beccb49540a68ce1b84d68f5a6d75ff27e4a66153a38090141047bb270276d9ac8521fd5e3321172438274e7e5bb9ee08c2c4b7e09a1a4dab43ace33e7d03d6a250716ae3c407aa287522d716cba4da3f3ca72f8f65e0e6403b1ffffffff88e7da11a1721abe7cfee3875249414822738255e5349a40ecc860f7e5320b10010000008c493046022100a7a75e2c0b4533b921eb6144e71bc54bfe10ecc8cb74040eea84bec7b28b7c24022100defd6aa8d9612021c75d70999dcbb79c1c245670bfa2d106d95ffe4870c13a270141045574d0e35cbe81f6eae2a445cc75918889b1e8ed48b696ab713172f5c8a9eb7af3e3f77c4106925a99ab432cd5758d769ccf223a2c4a53cccb1625984276b7eeffffffffc4d8a2bb3131f6590b64d4d191da04b2697296611b67c229f78804b7ceaca2b7010000008a47304402202abcb1c28821fd4c3b0e257e1816868eccbd341880ca71673160d7c00e7a4da102201858bba32697bd00df961b08292c315370539155c4997cd3350500ee0a5485f4014104b1d64edb2024df922ab53c7335667d111b191db59396eba7a05b0b1e45f30c8a4e82c2aac4f8fc535cc8163c99e2d9012baac08be4d39266717d853cf568aeb2ffffffffc5dc4e767ce75bbccb7d2b4c903dac37c4f3fe846be150fb5b70cb420871f304000000008b483045022013f39eae31043db3733f22876df9439319e7795a3787fffb564402011c17d51b02210089ca0d47aa734e6a97ab5ad6d78e6df8aca3006e18c814eeec935a656b788b420141048ca10b1f96ea9121b792dad27314c4f2d7d143c27d677a78bd4a92a2b9e0f00d4c139930bdd961bc857336ce6112ac00b08babb683971902aa4464152df0b01affffffffd63e2e5fdbd2b23c0928ac800ee92fe9d0b0c9294b4ae8058ae257dbed8e5fbe010000008a473044022075fb3ce4a262b50a7acc53008564e0bd8c3e8b7cc1aea3a76d6271aa36878c1702202a2a95ccaf60605319b76ab502a11be2f5a2bd6b04ca4a88ede2d28cfedc3947014104bc127da7c43db68ff9629f0ef03fc88776192bd57a1a61276de87edce45ba0fa6f995fad30da98a117e36a568ea3573c624c8425a66a226a8250e5a5e914af88ffffffffe7ac75ecd6b578a77ddc8d20d923305cad025c7857a76f235748101e69f57de4000000008a473044022072e096284c9200b98b2a29d93bdcfec1feb71c01f244b17dd3718dfc7b44ffa00220784ae5df75fd6217596eb62659e2e1cbe30f41f87dac3759e5c895aaa3f8222c014104f5f8e007ec1245032d874cac5a6b47c66770aec2e75249d35828f2de1e2c34085d9123e0cdda50931342f2e3e7ba329209c1e7f15227fb7fe2d88396cc1ff4a8ffffffffed6365140806b76b3c63b8f4e08f680bd1079311afd85f34919de085ea06f26e010000008b48304502206fd81621359b7fdcc630b1aff5c3b99649629b5bf220721df4f13692943d4b23022100fec3b0bc7b1566468883203fc225357c5ce7a1dea14765e5205c7b47f8a74c6b014104a2a14d31b09f9f092923e369e7c178b9a0a2c18823e025464c36b9316cc584e1ed6a57636c46dfd606a07745e7782e7e9ca66dc5b94aa18b57e2b0b765b7c60effffffff17428a35033d54cdc92d9f43c74a10aef5d9ce134fc20192fecab8d62c6053de000000008b48304502203f5a85708be3abeb8bb65c3cb52b25252c7e63911b84c5ae8d789e5934dc5b5a022100a3141aaea97e800a91be6bf83aeebbcb618fc24c076fda66b1f7af2c68fe7c3c01410457112dbe0c163a8a01a107c91ec0174d05c63dec4e6ed57ccaf40f4ae5d233970748f9744850f0906bb96cfa948bade06e494c3b3c90e50886fe994304d5f809ffffffff5de047a2c0e32fe748ad973e415cfcfaf28c0fc44ba2186dae1132973be4bd58010000008a47304402203fdac3e2f69fc9acd12c62f55176ca58c8b693e9afda98d64f0977e5a5409a2a022052e337d6d28bf8c70ecb77c952f3230a146bbf8ce932636af35d342fb4af1d420141041892faf0295d9b1179dcc4f6be2ee2822b551bf45fea857970e8374e22387c32931433893b1d39c4dadfe38729cf4f71600f312459c224f0d4a4922fa2b4ce3bffffffffa60d78811a6e65c77a0c1c824fd91e7623db5eac45871b5e943c5131ab2a84e1010000008a473044022019592aa90d01839d1d095073023ba38e10ca6670be985a72641af1f45049373c022009f43d42d8230a655562811bc231db02581bd9769b19a427a282c4216797e9a1014104c9df95dcc833ed9b8767eecb6db2962a8e7a4fefd0b32f2d0f80d146a9db2df4ac7035a30720453877faac574f4f7942295ec5f2db00db8f5c7b1c4f925a60caffffffff9547c9ce2820cb7130d180db08d89bc775a11a40182997486cbda6c67598ee72010000008b483045022100ed210baae6fb090700e5eb68ff9f4fb0da33046f5aad26c9a87d691a7dc5dce002201cdab212846a98c9e78362042470204b8ebb9b1b17c8ae6cad20d2d539e4f44c014104aa7a6ce03b97d86a6f3d2c9fd6871940f7987b6ae5c190dc324e6e02923d6681134116a38bf8d146ad4be564ae186b5c096c7c31ba7b84ef50295aab554e10c2ffffffff01c0149716000000001976a914b472a266d0bd89c13706a4132ccfb16f7c3b9fcb
msg = append(msg, 88ac00000000)
    = 01000000130561acc9c1b5dcfd4289eea18f2e20cb33dc43c2a895a11cda123bdf57919999000000008c493046022100a410fa0b0e3dd0fd433a3a3e887ece64b3a559cac2325ea9bf272d665a2901d2022100b425ffef10fd026886a50492077adee3dadae4ecc18ff71c1cd05d1d8d127cc201410441c23ceab6f92741f0a33d790ac1f03fd91c7f4aaf6dd1d0edda34751ce82cf522f45dcbffb865b2084140b319a3f184f6de3ab0c5c2e5f32c5aaf36ddb863a2ffffffff40a5f7b88e5c88a39616c3519874b39f5f1206427cadbd0a68396f41e7563c27000000008b483045022100a1b63f41aff0f1783f0125d6aa2e0e678047ea1a571e627926fc1623007245a40220050c1dce764d9ae5d8e474db59c18ae69bc3c9fc03c86879d279ff9bfb194fca014104a350328bf4c82ddece174f63cf4e9a8883e3822af7829bd21f59b423464f021280a6997d40b319e727c8e13393cdca66d0037edf0558a7360b2f8bf83f000490ffffffff4b20a61d13e29453c2ff63c7935732f4521f1ee0c869dc167b6556b2eb78ad98000000008a47304402205e2cc53edfd274ea4b2ca4657225066008718e1d4d94fc30bed2121e166338f5022008cfff59838a407de7c4bf4ab8ecb7d7e90a0045645938f6e5a4a25acd16ef27014104c851279ed4af7728d31432ccbaeedcdc5a6af5566473167be77a0088ba78ac9bac3d82c9ff798e8d5e32bfcfa7b1c4c4bb1c830787449f4d98907243c30eab8fffffffff61f78a654f7373474eba7c6b9ef12373a13e98797d46d2981dcf5fd0ec49c1fb010000008a47304402207ad4d6aeb5f3d96b0fd5cfe4a42b2d6d3518bd944523a406fbd47ad6995412920220240ef3c45a451a3fe4d79591d790bbb0bc15dbcc9750df9493f0a2d8ad1e571e0141042da834df1687d25f47ed4c0a8e11c8e687537aefd8207c1566c2e5f10300b166c5653a5333034e706077cfd098ebf8fb75e0354ce67bb38c0a5c67106dd4ce78ffffffff73f6ab040068d59a58ce097018f930d42fb1233c2261e9e407c759bc517a462c000000008b48304502206da5a6b10aabe1c9414ebcf5c35a0739a8d33b382e79f4e7b0f408ee3ae68844022100ab122422b28430d412c634f089aecb2903360cbf34e3dfdce62976ad8eee05520141042062ed24bf555cb437697c9119356f30cb5493bbd84dd33d9e6e9b8472da9990bbdcd052c7032f7d2c57baeae27041cf22849c8bdb5702ebddc1e970f92ac738ffffffff77b2475095bd6b55feba3880ec127929c6d632c2e8f56ac6fd2a2fc9d967ce9f010000008a47304402205bfaa2486c2afa51735ce76b01cdf81039b912d4b1b9a6c153d6260d82cd167e022026c9b81979796f235cf5b5cdfc6afb7e1d857e9da959e7dfeaccf1da18b95a8001410499968e625eb4bea5b901c42a0ecfb655f667afaf6efeb81b8c1aa82d1f64b8ee3111f5b7901ed83c43c50e98c0596c35a6a2d986d12ec5172082496d1b8a97a4ffffffff7a973430e44ea01ae8bf2cc9e693502e685cb4cd2dfe2008f3d9b8da64ca53cf000000008b48304502207544def2ea18aac14e3a6793cc2e6fc5c231f12103368b7e9b7f941a30b738110221008f159173769faf3c836b989426a0e6829d93f5ee0f9d0d48ec0dba1df4c7a0af014104213538311ede60d2011e50d53c6353faa50d97ec2a5a76904c66b0280e501e9263ec8209cce83f38b543c73b6db26c08ae72c961cfdc0e605afb2ee928b7dd1dffffffff7cca655432ffac34ef48e0c331912a0070b91ddef00993b5e55d1a676ad9152e000000008b483045022100d3b0d45692b21bb42871335bd48a98421965c8ba652af74a7fa76c32e68cacfc02207c9c2aa5058a65e5bd13e1a04f7bbf48c7b3b7cce3792eaa8fbb76fba69da0d9014104024988ee444d472e7ff01a47cea4733c8a0150cb35bfa15d3f7fb5b604d69141e6af9befbf5f449fd461a1e011271ede669e1c5e0775ef57c3c63c114519dd14ffffffff86d068e2d393af432878fe300c7b9135adac0e8666e1ad4d82a53c2b1d640718010000008b48304502203ecac1954956b42c98cce53851962157f893964148152f96e3526c06404b45f7022100f9fe629c06759832b1beccb49540a68ce1b84d68f5a6d75ff27e4a66153a38090141047bb270276d9ac8521fd5e3321172438274e7e5bb9ee08c2c4b7e09a1a4dab43ace33e7d03d6a250716ae3c407aa287522d716cba4da3f3ca72f8f65e0e6403b1ffffffff88e7da11a1721abe7cfee3875249414822738255e5349a40ecc860f7e5320b10010000008c493046022100a7a75e2c0b4533b921eb6144e71bc54bfe10ecc8cb74040eea84bec7b28b7c24022100defd6aa8d9612021c75d70999dcbb79c1c245670bfa2d106d95ffe4870c13a270141045574d0e35cbe81f6eae2a445cc75918889b1e8ed48b696ab713172f5c8a9eb7af3e3f77c4106925a99ab432cd5758d769ccf223a2c4a53cccb1625984276b7eeffffffffc4d8a2bb3131f6590b64d4d191da04b2697296611b67c229f78804b7ceaca2b7010000008a47304402202abcb1c28821fd4c3b0e257e1816868eccbd341880ca71673160d7c00e7a4da102201858bba32697bd00df961b08292c315370539155c4997cd3350500ee0a5485f4014104b1d64edb2024df922ab53c7335667d111b191db59396eba7a05b0b1e45f30c8a4e82c2aac4f8fc535cc8163c99e2d9012baac08be4d39266717d853cf568aeb2ffffffffc5dc4e767ce75bbccb7d2b4c903dac37c4f3fe846be150fb5b70cb420871f304000000008b483045022013f39eae31043db3733f22876df9439319e7795a3787fffb564402011c17d51b02210089ca0d47aa734e6a97ab5ad6d78e6df8aca3006e18c814eeec935a656b788b420141048ca10b1f96ea9121b792dad27314c4f2d7d143c27d677a78bd4a92a2b9e0f00d4c139930bdd961bc857336ce6112ac00b08babb683971902aa4464152df0b01affffffffd63e2e5fdbd2b23c0928ac800ee92fe9d0b0c9294b4ae8058ae257dbed8e5fbe010000008a473044022075fb3ce4a262b50a7acc53008564e0bd8c3e8b7cc1aea3a76d6271aa36878c1702202a2a95ccaf60605319b76ab502a11be2f5a2bd6b04ca4a88ede2d28cfedc3947014104bc127da7c43db68ff9629f0ef03fc88776192bd57a1a61276de87edce45ba0fa6f995fad30da98a117e36a568ea3573c624c8425a66a226a8250e5a5e914af88ffffffffe7ac75ecd6b578a77ddc8d20d923305cad025c7857a76f235748101e69f57de4000000008a473044022072e096284c9200b98b2a29d93bdcfec1feb71c01f244b17dd3718dfc7b44ffa00220784ae5df75fd6217596eb62659e2e1cbe30f41f87dac3759e5c895aaa3f8222c014104f5f8e007ec1245032d874cac5a6b47c66770aec2e75249d35828f2de1e2c34085d9123e0cdda50931342f2e3e7ba329209c1e7f15227fb7fe2d88396cc1ff4a8ffffffffed6365140806b76b3c63b8f4e08f680bd1079311afd85f34919de085ea06f26e010000008b48304502206fd81621359b7fdcc630b1aff5c3b99649629b5bf220721df4f13692943d4b23022100fec3b0bc7b1566468883203fc225357c5ce7a1dea14765e5205c7b47f8a74c6b014104a2a14d31b09f9f092923e369e7c178b9a0a2c18823e025464c36b9316cc584e1ed6a57636c46dfd606a07745e7782e7e9ca66dc5b94aa18b57e2b0b765b7c60effffffff17428a35033d54cdc92d9f43c74a10aef5d9ce134fc20192fecab8d62c6053de000000008b48304502203f5a85708be3abeb8bb65c3cb52b25252c7e63911b84c5ae8d789e5934dc5b5a022100a3141aaea97e800a91be6bf83aeebbcb618fc24c076fda66b1f7af2c68fe7c3c01410457112dbe0c163a8a01a107c91ec0174d05c63dec4e6ed57ccaf40f4ae5d233970748f9744850f0906bb96cfa948bade06e494c3b3c90e50886fe994304d5f809ffffffff5de047a2c0e32fe748ad973e415cfcfaf28c0fc44ba2186dae1132973be4bd58010000008a47304402203fdac3e2f69fc9acd12c62f55176ca58c8b693e9afda98d64f0977e5a5409a2a022052e337d6d28bf8c70ecb77c952f3230a146bbf8ce932636af35d342fb4af1d420141041892faf0295d9b1179dcc4f6be2ee2822b551bf45fea857970e8374e22387c32931433893b1d39c4dadfe38729cf4f71600f312459c224f0d4a4922fa2b4ce3bffffffffa60d78811a6e65c77a0c1c824fd91e7623db5eac45871b5e943c5131ab2a84e1010000008a473044022019592aa90d01839d1d095073023ba38e10ca6670be985a72641af1f45049373c022009f43d42d8230a655562811bc231db02581bd9769b19a427a282c4216797e9a1014104c9df95dcc833ed9b8767eecb6db2962a8e7a4fefd0b32f2d0f80d146a9db2df4ac7035a30720453877faac574f4f7942295ec5f2db00db8f5c7b1c4f925a60caffffffff9547c9ce2820cb7130d180db08d89bc775a11a40182997486cbda6c67598ee72010000008b483045022100ed210baae6fb090700e5eb68ff9f4fb0da33046f5aad26c9a87d691a7dc5dce002201cdab212846a98c9e78362042470204b8ebb9b1b17c8ae6cad20d2d539e4f44c014104aa7a6ce03b97d86a6f3d2c9fd6871940f7987b6ae5c190dc324e6e02923d6681134116a38bf8d146ad4be564ae186b5c096c7c31ba7b84ef50295aab554e10c2ffffffff01c0149716000000001976a914b472a266d0bd89c13706a4132ccfb16f7c3b9fcb88ac00000000
msg = sha256(msg)
    = a22a0580ccf9aa60f1226333e00a89a10aa2c59497ddb0dbdc2fb53b61f10240
msg = sha256(msg)
    = b4aa2edb000918d40dc0b2bfdc7233aa3b9e0d85fef231245992403817db9993
msg = prepend(msg, db8b8abf653b8b01fbcb7df85e51a2dcb8af6a4b914a0c0aa1e20569782a3942)
    = db8b8abf653b8b01fbcb7df85e51a2dcb8af6a4b914a0c0aa1e20569782a3942b4aa2edb000918d40dc0b2bfdc7233aa3b9e0d85fef231245992403817db9993
msg = sha256(msg)
    = d98ede85d13cd74c7ecf2333b0604916b9b73a34fdfa17d0ce9e3642f458df8b
msg = sha256(msg)
    = 976dc8f340dd579fba714ce2fe1073c06402cf6e86ed71a9399a9464faf91938
msg = prepend(msg, c4403ec528831424827ffb31d7669abf97195cd3d5dc766cec7132532acb2252)
    = c4403ec528831424827ffb31d7669abf97195cd3d5dc766cec7132532acb2252976dc8f340dd579fba714ce2fe1073c06402cf6e86ed71a9399a9464faf91938
msg = sha256(msg)
    = 01706a982009b0de53ac0a60c05899e280cc78f83f14d539cb93fb357727e022
msg = sha256(msg)
    = 9ec884fb5542d2411a910adb21cd4792598dae35d5e669f8c9ca311eb87b25bb
msg = append(msg, 7dc890135ee588f6f1e246da812c8eb5319c8fb40ceb7b46472c365c43182fde)
    = 9ec884fb5542d2411a910adb21cd4792598dae35d5e669f8c9ca311eb87b25bb7dc890135ee588f6f1e246da812c8eb5319c8fb40ceb7b46472c365c43182fde
msg = sha256(msg)
    = 820d18d72a481436ea1dcf8bd0988f591457c5886044cfd6b7942f0631c21c53
msg = sha256(msg)
    = fd8054f607f0758fb025f2feba057857c681ebe8b016152b219e4b129f13c5a5
msg = prepend(msg, 8146c6a5292fc8c1a232339ee9c30e40b3a0ee9b6eff8afd3379c6dc93d08ddb)
    = 8146c6a5292fc8c1a232339ee9c30e40b3a0ee9b6eff8afd3379c6dc93d08ddbfd8054f607f0758fb025f2feba057857c681ebe8b016152b219e4b129f13c5a5
msg = sha256(msg)
    = b178e12d4872c8d7dfa88d235aab657abe7ee25f18a9b906e823b1499060ed41
msg = sha256(msg)
    = df43a9421c0c7ea0d3c68650a34be9752eeee7115bc6f9cf164df6527261de5b
msg = prepend(msg, 7a7ee1aa6aa677be468a5db3b04cdc136a92fe7cb0e52ea5719cc2c80669ccd4)
    = 7a7ee1aa6aa677be468a5db3b04cdc136a92fe7cb0e52ea5719cc2c80669ccd4df43a9421c0c7ea0d3c68650a34be9752eeee7115bc6f9cf164df6527261de5b
msg = sha256(msg)
    = 4181c9af7205ef526ff6db609ff33e7fc863cca9b401023f321458dd6c18ee9e
msg = sha256(msg)
    = 9b31bbc0d15e45b4d848117df858509c7c1e6ed46dffa6dcfc064244beb3bb6d
msg = prepend(msg, b199d3b3e9c0234a7c83f5e431a9668a0c7658b1a4934db9ec09d9ea0cd2540e)
    = b199d3b3e9c0234a7c83f5e431a9668a0c7658b1a4934db9ec09d9ea0cd2540e9b31bbc0d15e45b4d848117df858509c7c1e6ed46dffa6dcfc064244beb3bb6d
msg = sha256(msg)
    = 9e2ef7cd4c3a6127225e4d7fcd70ea31562623c8ed39213804f2c2d98e1aa418
msg = sha256(msg)
    = df8e90fed3ff14362a7f2f4da813952a88c8a4a4f2ac88191e9e0fcf86b562f9
msg = append(msg, bee12382dd6f920af4ea145b114cf2c451506d8ef4c9b964fed695a099395351)
    = df8e90fed3ff14362a7f2f4da813952a88c8a4a4f2ac88191e9e0fcf86b562f9bee12382dd6f920af4ea145b114cf2c451506d8ef4c9b964fed695a099395351
msg = sha256(msg)
    = 4058290cde9b64fa7d21fe3f69460cf97a7f80148ac0bcdf48b08566b469f005
msg = sha256(msg)
    = 9ddd1a9dc1743d623a7dce1d2ab8d4269705b09880102e1eab2a665aa05e07f6
msg = append(msg, 37efcd6972b79eddda5191ff7dc25f61d44963def1529af55ff8fd893a470c1c)
    = 9ddd1a9dc1743d623a7dce1d2ab8d4269705b09880102e1eab2a665aa05e07f637efcd6972b79eddda5191ff7dc25f61d44963def1529af55ff8fd893a470c1c
msg = sha256(msg)
    = db8d4e4d8a84fdc5e9d8c0e1e192c452b5f187cfbe8f0e47172736c20dad5251
msg = sha256(msg)
    = 715b7e36276a66d842e56dd102c9d9eddfe4d9f2dfa908ae31157ac2c2fd29db
bitcoinVerify(msg, 129405)`;

const helloWorld: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEIA7ogTlDRJuRnTABeBNguhMITZngK8fQ71Uo3gWtqs0AD8cgBAQAAAAHkgvnTLsw7ple2nYmAEIV7VEV6kEl5gv9W+XxOxY5vmAEAAABrSDBFAiEAslOt0dHPkIRDOKR1oE/xP8nnvSQrB3Yt6gf1YIst42cCIACyaMqcM0KzdpzdBiiRMXzc74eqwxC2hV6dk4mOu+jsASECDY5NEH0rM5sAUO/dS0oJJFqgVgSPElOWN06moqsHCcb/////AmUz5gUAAAAAGXapFAvwV9QPu6Z0SGJRX1tVojEN5XcviKyghgEAAAAAABl2qRTwBoisAAAAAAgI8SCph/cWxTORPDFMeONdNYhMrJQ/pCysSdKyxp9AA/hfiAgI8SDexVs0h+Hj9yKkm1WneDIVhieF9KOss5KEYBn3HcZKnQgI8SCyyhj0heCAR44CXas9RktBbA4ey2Ypya786MghTQQkMggI8CARsOkGYRlv9LCBPD7aFBurXpFgSDe996DJ3zfbDjoRmAgI8CDDS8GkoQk//RSMAWseZkdCkU6Tnvq+TT01ZRWRSybZ4ggI8CDD5ufDjGn2ryTCvjTrrEglft5h7AohuVNeREMne+MGRggI8SAHmL+GBuAAJOXV1UvwyWD2Kd+52taRV0VbbyZSwOjegQgI8CA/mtptYLqiRABrsKrVFEitL6+51LZIegmZz/JrkfD1NggI8SDHAwGelZqN0/rvdIm7MoukhVdHWOcJHwFGTrZYcsl1yAgI8CDL/v/1E/+EuRXj/tb515lnZjD4Nk6ipsdVf62UpbXXiAgI8SAL4jcJhZkTur1EYLvd+O0hPnyHc6Sx+s4w+Kz98JO3BQgIAAWIlg1z1xkBA/fvFQ==`,
);
const helloWorldInfo: string = `# version: 1
msg = sha256(FILE)
    = 03ba204e50d126e4674c005e04d82e84c21366780af1f43bd54a37816b6ab340
msg = ripemd160(msg)
    = 1df8859e60bc679503d16dcb870e6ce91a57e9df
msg = prepend(msg, 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a914)
    = 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a9141df8859e60bc679503d16dcb870e6ce91a57e9df
msg = append(msg, 88ac00000000)
    = 0100000001e482f9d32ecc3ba657b69d898010857b54457a90497982ff56f97c4ec58e6f98010000006b483045022100b253add1d1cf90844338a475a04ff13fc9e7bd242b07762dea07f5608b2de367022000b268ca9c3342b3769cdd062891317cdcef87aac310b6855e9d93898ebbe8ec0121020d8e4d107d2b339b0050efdd4b4a09245aa056048f125396374ea6a2ab0709c6ffffffff026533e605000000001976a9140bf057d40fbba6744862515f5b55a2310de5772f88aca0860100000000001976a9141df8859e60bc679503d16dcb870e6ce91a57e9df88ac00000000
msg = sha256(msg)
    = 9c6aa9591003377455b6f27fc71b5acfa5fbb2fa49362fa87a25ef0d799dd462
msg = sha256(msg)
    = ecb27c6264dc88ef9b8a77fa9a53903f4c81be4a2fe2b2519e2daa9d7d0f9f7e
msg = prepend(msg, a987f716c533913c314c78e35d35884cac943fa42cac49d2b2c69f4003f85f88)
    = a987f716c533913c314c78e35d35884cac943fa42cac49d2b2c69f4003f85f88ecb27c6264dc88ef9b8a77fa9a53903f4c81be4a2fe2b2519e2daa9d7d0f9f7e
msg = sha256(msg)
    = e7b919aef5283e190c46d8cc4df2f1ff5343dcdb730638438cb28c16e0b829f0
msg = sha256(msg)
    = 169be2743153b2bb751136acee44d14200ddc9e49cf6594af8d2d2a2104b6228
msg = prepend(msg, dec55b3487e1e3f722a49b55a7783215862785f4a3acb392846019f71dc64a9d)
    = dec55b3487e1e3f722a49b55a7783215862785f4a3acb392846019f71dc64a9d169be2743153b2bb751136acee44d14200ddc9e49cf6594af8d2d2a2104b6228
msg = sha256(msg)
    = a08c812aaaa5dc42e24674d988d652d42115d1b30470e34431abbc8c74accd0c
msg = sha256(msg)
    = dda599c3662f06e455656173195c805ad31bde2dd7c6e058e3c938d2fa6a6d06
msg = prepend(msg, b2ca18f485e080478e025dab3d464b416c0e1ecb6629c9aefce8c8214d042432)
    = b2ca18f485e080478e025dab3d464b416c0e1ecb6629c9aefce8c8214d042432dda599c3662f06e455656173195c805ad31bde2dd7c6e058e3c938d2fa6a6d06
msg = sha256(msg)
    = 4f5fb40ee3f02eafe3b9c4c2cdd0787dcc0f6cbf622dd17e04155fa4da74ff75
msg = sha256(msg)
    = 20a48517b9e288c46b48987110b4d62056ec4c5234b1dac7ec2af867b13c850a
msg = append(msg, 11b0e90661196ff4b0813c3eda141bab5e91604837bdf7a0c9df37db0e3a1198)
    = 20a48517b9e288c46b48987110b4d62056ec4c5234b1dac7ec2af867b13c850a11b0e90661196ff4b0813c3eda141bab5e91604837bdf7a0c9df37db0e3a1198
msg = sha256(msg)
    = 829037f5e71c2168fdc9169fd1d361b8dc027ec98ecfecfb7b141b29555d4121
msg = sha256(msg)
    = 16a800adc6c37b8bdd800e9b48e67b0b62912061a785c892fad592116b57cab8
msg = append(msg, c34bc1a4a1093ffd148c016b1e664742914e939efabe4d3d356515914b26d9e2)
    = 16a800adc6c37b8bdd800e9b48e67b0b62912061a785c892fad592116b57cab8c34bc1a4a1093ffd148c016b1e664742914e939efabe4d3d356515914b26d9e2
msg = sha256(msg)
    = 35372e44256cf9c49a51d7f17185ac4d5417c81cdde359c5e91e89d3c0cdb0f9
msg = sha256(msg)
    = 535cc781a96fc168ad1abf2757999e77c71ab3aa24b926d73a1ca9c6ba029614
msg = append(msg, c3e6e7c38c69f6af24c2be34ebac48257ede61ec0a21b9535e4443277be30646)
    = 535cc781a96fc168ad1abf2757999e77c71ab3aa24b926d73a1ca9c6ba029614c3e6e7c38c69f6af24c2be34ebac48257ede61ec0a21b9535e4443277be30646
msg = sha256(msg)
    = 9d5440dbb399e24d04a39f219f84bfba45e9159d52f5be3d56e93291d03b7ae9
msg = sha256(msg)
    = 83b0b3b5d451418ddc864bf34afba138fd0541469fa00977756877a6c36fc1dd
msg = prepend(msg, 0798bf8606e00024e5d5d54bf0c960f629dfb9dad69157455b6f2652c0e8de81)
    = 0798bf8606e00024e5d5d54bf0c960f629dfb9dad69157455b6f2652c0e8de8183b0b3b5d451418ddc864bf34afba138fd0541469fa00977756877a6c36fc1dd
msg = sha256(msg)
    = ae2b925b5e50f03f9b42fbe85368812799e13b19d8812cd7779057395795ac79
msg = sha256(msg)
    = d4637af05f82eddc4e4254f340e0bebaf6713c70f21d538736483f07292392c6
msg = append(msg, 3f9ada6d60baa244006bb0aad51448ad2fafb9d4b6487a0999cff26b91f0f536)
    = d4637af05f82eddc4e4254f340e0bebaf6713c70f21d538736483f07292392c63f9ada6d60baa244006bb0aad51448ad2fafb9d4b6487a0999cff26b91f0f536
msg = sha256(msg)
    = af3c11e76808d7aa9753d8478c0d468444db5eb5bc26b7511813bfc5f630e19b
msg = sha256(msg)
    = efa898490f9cc0dcd698220e9a9c1acc01b54c1c14b23520ace3cd82341f6b45
msg = prepend(msg, c703019e959a8dd3faef7489bb328ba485574758e7091f01464eb65872c975c8)
    = c703019e959a8dd3faef7489bb328ba485574758e7091f01464eb65872c975c8efa898490f9cc0dcd698220e9a9c1acc01b54c1c14b23520ace3cd82341f6b45
msg = sha256(msg)
    = 04853c771da47330c3f89d117fe84f8f031ac1485572e71f0b8c54a5e5e20df9
msg = sha256(msg)
    = cbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788
msg = append(msg, cbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788)
    = cbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788cbfefff513ff84b915e3fed6f9d799676630f8364ea2a6c7557fad94a5b5d788
msg = sha256(msg)
    = 8a061c45c453f4af4b9b36b006f90bac2f6fcbe3a9f70f4267c6e623b68b8d4e
msg = sha256(msg)
    = 3f10376d0aebb4647ff550b60d69ba5ad6b6809d51af6a6476e0312a9433a3bf
msg = prepend(msg, 0be23709859913babd4460bbddf8ed213e7c8773a4b1face30f8acfdf093b705)
    = 0be23709859913babd4460bbddf8ed213e7c8773a4b1face30f8acfdf093b7053f10376d0aebb4647ff550b60d69ba5ad6b6809d51af6a6476e0312a9433a3bf
msg = sha256(msg)
    = faa6e88835c144ad73f48992bc05e691a52a9199df02450194f3a03b530dc2d7
msg = sha256(msg)
    = 007ee445d23ad061af4a36b809501fab1ac4f2d7e7a739817dd0cbb7ec661b8a
bitcoinVerify(msg, 358391)`;

const incomplete: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEIBcT2FqjlMQ0Z2TjP12mGTX9MzcLKi0ebEK+DVksJevnwEOdUv5OAan66poDve9ARS/QI8BC1c+iFDP2eY9HwQ/u2/CUOCPEEV8+lxPAIb7GsjU5OsOcAg9/jDS75DI4uLWh0dHBzOi8vYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==`,
);
const incompleteInfo: string = `# version: 1
msg = sha256(FILE)
    = 05c4f616a8e5310d19d938cfd769864d7f4ccdc2ca8b479b10af83564b097af9
msg = append(msg, e754bf93806a7ebaa680ef7bd0114bf4)
    = 05c4f616a8e5310d19d938cfd769864d7f4ccdc2ca8b479b10af83564b097af9e754bf93806a7ebaa680ef7bd0114bf4
msg = sha256(msg)
    = cd567f5aa9f68cfbece1ca17b4b72ad3079a3e4bff80efe131419bd02138e425
msg = append(msg, b573e8850cfd9e63d1f043fbb6fc250e)
    = cd567f5aa9f68cfbece1ca17b4b72ad3079a3e4bff80efe131419bd02138e425b573e8850cfd9e63d1f043fbb6fc250e
msg = sha256(msg)
    = 6716df9bd9e83595bce439c58108d8fcc1678f30d4c6731c3f1fa6c79ed712c6
msg = prepend(msg, 57cfa5c4)
    = 57cfa5c46716df9bd9e83595bce439c58108d8fcc1678f30d4c6731c3f1fa6c79ed712c6
msg = append(msg, 6fb1ac8d4e4eb0e7)
    = 57cfa5c46716df9bd9e83595bce439c58108d8fcc1678f30d4c6731c3f1fa6c79ed712c66fb1ac8d4e4eb0e7
pendingVerify(msg, https://alice.btc.calendar.opentimestamps.org/)`;

const knownAndUnknownNotary: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEI0oiy7iErAePl9tMz3zpNU/KSzD8HsJATwLQMjn3LnAPwEEbYQr1dg3fg9CBBvsm9pmcI//AQMyxXL5xLjV252ZdY1I//NAjxBFfonzjwCHPG3E0MvCnwAIPf4w0u+QyOLCtodHRwczovL2JvYi5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn8BDnrSkHbxiAM9IHZ2Aso6jgCPEEV+ifN/AIYt9WNxriPY0AAQIDBAUGBwgueHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eA==`,
);
const knownAndUnknownNotaryInfo: string = `# version: 1
msg = sha256(FILE)
    = d288b2ee212b01e3e5f6d333df3a4d53f292cc3f07b09013c0b40c8e7dcb9c03
msg = append(msg, 46d842bd5d8377e0f42041bec9bda667)
    = d288b2ee212b01e3e5f6d333df3a4d53f292cc3f07b09013c0b40c8e7dcb9c0346d842bd5d8377e0f42041bec9bda667
msg = sha256(msg)
    = 95e2b314af1a11524778ade82197444350d46c60894e7839863a401746e5c00f
 -> msg = append(msg, 332c572f9c4b8d5db9d99758d48fff34)
        = 95e2b314af1a11524778ade82197444350d46c60894e7839863a401746e5c00f332c572f9c4b8d5db9d99758d48fff34
    msg = sha256(msg)
        = 173f127e0e8832929232858ca0b7241229d535b22073144a1a433b5aaa5d6cf4
    msg = prepend(msg, 57e89f38)
        = 57e89f38173f127e0e8832929232858ca0b7241229d535b22073144a1a433b5aaa5d6cf4
    msg = append(msg, 73c6dc4d0cbc29f0)
        = 57e89f38173f127e0e8832929232858ca0b7241229d535b22073144a1a433b5aaa5d6cf473c6dc4d0cbc29f0
    pendingVerify(msg, https://bob.btc.calendar.opentimestamps.org/)
 -> msg = append(msg, e7ad29076f188033d20767602ca3a8e0)
        = 95e2b314af1a11524778ade82197444350d46c60894e7839863a401746e5c00fe7ad29076f188033d20767602ca3a8e0
    msg = sha256(msg)
        = c0b849c680f7c6e13c719a3bfa96ce53c83095eca7c5a244ca991aeebbc87a4e
    msg = prepend(msg, 57e89f37)
        = 57e89f37c0b849c680f7c6e13c719a3bfa96ce53c83095eca7c5a244ca991aeebbc87a4e
    msg = append(msg, 62df56371ae23d8d)
        = 57e89f37c0b849c680f7c6e13c719a3bfa96ce53c83095eca7c5a244ca991aeebbc87a4e62df56371ae23d8d
    unknownVerify<0102030405060708>(msg, 78787878787878787878787878787878787878787878787878787878787878787878787878787878787878787878)`;

const merkle1: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEI0y/umoJ/Wg1YD4C+t+3OZi3Zn81lkeTvimJEQD3wt8nwEAIBo2rAxzaS0c7cq/8GCesI8CCfQphMzblq3beYhOcUzGtrBZxo8qw6LgfFGYwi2QTeFAjwIAJjVueXLwI5MOyEwhOt7cQFBGCXOTW70vTfPXvV3sVfCP/wEC4SBQr9ehDqT1ke1xfTXeYI8QRX2YLf8Aix8m4uVVkEdwCD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn8BBKqt6cL/uFPM/5wHaB0Bn9CPEEV9mC4PAIZkTvcTBxdioAg9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5vcmc=`,
);
const merkle1Info: string = `# version: 1
msg = sha256(FILE)
    = d32fee9a827f5a0d580f80beb7edce662dd99fcd6591e4ef8a6244403df0b7c9
msg = append(msg, 0201a36ac0c73692d1cedcabff0609eb)
    = d32fee9a827f5a0d580f80beb7edce662dd99fcd6591e4ef8a6244403df0b7c90201a36ac0c73692d1cedcabff0609eb
msg = sha256(msg)
    = ae59d2c0d2f5efa97df8f3cca7e85845880c102237f1a6a1b0b4c6a5ab77f494
msg = append(msg, 9f42984ccdb96addb79884e714cc6b6b059c68f2ac3a2e07c5198c22d904de14)
    = ae59d2c0d2f5efa97df8f3cca7e85845880c102237f1a6a1b0b4c6a5ab77f4949f42984ccdb96addb79884e714cc6b6b059c68f2ac3a2e07c5198c22d904de14
msg = sha256(msg)
    = 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15
msg = append(msg, 026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f)
    = 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f
msg = sha256(msg)
    = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa
 -> msg = append(msg, 2e12050afd7a10ea4f591ed717d35de6)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa2e12050afd7a10ea4f591ed717d35de6
    msg = sha256(msg)
        = 8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = prepend(msg, 57d982df)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = append(msg, b1f26e2e55590477)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0b1f26e2e55590477
    pendingVerify(msg, https://alice.btc.calendar.opentimestamps.org/)
 -> msg = append(msg, 4aaade9c2ffb853ccff9c07681d019fd)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa4aaade9c2ffb853ccff9c07681d019fd
    msg = sha256(msg)
        = a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = prepend(msg, 57d982e0)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = append(msg, 6644ef713071762a)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f906644ef713071762a
    pendingVerify(msg, https://bob.btc.calendar.opentimestamps.org/)`;

const merkle2: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEIi9Wl8HtEUcKXVt9etR0ZT7WyDH6JgS2He7rTDYccWC/wELY9jyE9BHKYuKtFlazY5dAI8SCuWdLA0vXvqX3488yn6FhFiAwQIjfxpqGwtMalq3f0lAjwIAJjVueXLwI5MOyEwhOt7cQFBGCXOTW70vTfPXvV3sVfCP/wEC4SBQr9ehDqT1ke1xfTXeYI8QRX2YLf8Aix8m4uVVkEdwCD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn8BBKqt6cL/uFPM/5wHaB0Bn9CPEEV9mC4PAIZkTvcTBxdioAg9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5vcmc=`,
);
const merkle2Info: string = `# version: 1
msg = sha256(FILE)
    = 8bd5a5f07b4451c29756df5eb51d194fb5b20c7e89812d877bbad30d871c582f
msg = append(msg, b63d8f213d047298b8ab4595acd8e5d0)
    = 8bd5a5f07b4451c29756df5eb51d194fb5b20c7e89812d877bbad30d871c582fb63d8f213d047298b8ab4595acd8e5d0
msg = sha256(msg)
    = 9f42984ccdb96addb79884e714cc6b6b059c68f2ac3a2e07c5198c22d904de14
msg = prepend(msg, ae59d2c0d2f5efa97df8f3cca7e85845880c102237f1a6a1b0b4c6a5ab77f494)
    = ae59d2c0d2f5efa97df8f3cca7e85845880c102237f1a6a1b0b4c6a5ab77f4949f42984ccdb96addb79884e714cc6b6b059c68f2ac3a2e07c5198c22d904de14
msg = sha256(msg)
    = 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15
msg = append(msg, 026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f)
    = 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f
msg = sha256(msg)
    = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa
 -> msg = append(msg, 2e12050afd7a10ea4f591ed717d35de6)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa2e12050afd7a10ea4f591ed717d35de6
    msg = sha256(msg)
        = 8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = prepend(msg, 57d982df)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = append(msg, b1f26e2e55590477)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0b1f26e2e55590477
    pendingVerify(msg, https://alice.btc.calendar.opentimestamps.org/)
 -> msg = append(msg, 4aaade9c2ffb853ccff9c07681d019fd)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa4aaade9c2ffb853ccff9c07681d019fd
    msg = sha256(msg)
        = a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = prepend(msg, 57d982e0)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = append(msg, 6644ef713071762a)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f906644ef713071762a
    pendingVerify(msg, https://bob.btc.calendar.opentimestamps.org/)`;

const merkle3: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEIOWamn8NEEHu08wxXQwXZtFCN8suOZd1GAHos+xFrlXnwEA6bSasBNFCANc4ml/GtCYUI8SALyh7RcYxxkpEwpjnwp7gu65Go+kWxZRDJ7hX+xKC/FQj/8BAuEgUK/XoQ6k9ZHtcX013mCPEEV9mC3/AIsfJuLlVZBHcAg9/jDS75DI4uLWh0dHBzOi8vYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ/AQSqrenC/7hTzP+cB2gdAZ/QjxBFfZguDwCGZE73EwcXYqAIPf4w0u+QyOLCtodHRwczovL2JvYi5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn`,
);
const merkle3Info: string = `# version: 1
msg = sha256(FILE)
    = 3966a69fc344107bb4f30c574305d9b4508df2cb8e65dd46007a2cfb116b9579
msg = append(msg, 0e9b49ab0134508035ce2697f1ad0985)
    = 3966a69fc344107bb4f30c574305d9b4508df2cb8e65dd46007a2cfb116b95790e9b49ab0134508035ce2697f1ad0985
msg = sha256(msg)
    = 026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f
msg = prepend(msg, 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15)
    = 0bca1ed1718c71929130a639f0a7b82eeb91a8fa45b16510c9ee15fec4a0bf15026356e7972f023930ec84c213adedc4050460973935bbd2f4df3d7bd5dec55f
msg = sha256(msg)
    = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa
 -> msg = append(msg, 2e12050afd7a10ea4f591ed717d35de6)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa2e12050afd7a10ea4f591ed717d35de6
    msg = sha256(msg)
        = 8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = prepend(msg, 57d982df)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0
    msg = append(msg, b1f26e2e55590477)
        = 57d982df8b35bc0a91a93d6d17e0162868dc123bc8b1bbfab22af9268f7fea70376b5cb0b1f26e2e55590477
    pendingVerify(msg, https://alice.btc.calendar.opentimestamps.org/)
 -> msg = append(msg, 4aaade9c2ffb853ccff9c07681d019fd)
        = c8f78972680bec45199bf6f19472fe1db32ceeed4509c79f345086bf4888d3fa4aaade9c2ffb853ccff9c07681d019fd
    msg = sha256(msg)
        = a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = prepend(msg, 57d982e0)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f90
    msg = append(msg, 6644ef713071762a)
        = 57d982e0a2181eb7fd470600d82119b73d7ae5da2d8c84db7d55fd45b568fac036d86f906644ef713071762a
    pendingVerify(msg, https://bob.btc.calendar.opentimestamps.org/)`;

const twoCalendars: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEI76oXT2jllwV1dGD099IEvStTXP0ZTZ2UVBhzISlATdvwEIOQN+70Sd7G2sMiypc0fEUI//AQa0Ajtu3ToO7rCeXXGHI7ngjxBFfUZRXwCOrdZrFojVV0AIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5vcmfwEKOtcB758QU1qElotamdhYAI8QRX1GUW8Ahke5DqGycKlwCD3+MNLvkMjiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==`,
);
const twoCalendarsInfo: string = `# version: 1
msg = sha256(FILE)
    = efaa174f68e59705757460f4f7d204bd2b535cfd194d9d945418732129404ddb
msg = append(msg, 839037eef449dec6dac322ca97347c45)
    = efaa174f68e59705757460f4f7d204bd2b535cfd194d9d945418732129404ddb839037eef449dec6dac322ca97347c45
msg = sha256(msg)
    = 679a59f6661f9d809d6f72d2cc080a20435c5c793ace1961ca78e38693f2f53d
 -> msg = append(msg, 6b4023b6edd3a0eeeb09e5d718723b9e)
        = 679a59f6661f9d809d6f72d2cc080a20435c5c793ace1961ca78e38693f2f53d6b4023b6edd3a0eeeb09e5d718723b9e
    msg = sha256(msg)
        = fdd8c2334c77b1f204338bb2178d73e523988d7dcda13259d3a099f31623755d
    msg = prepend(msg, 57d46515)
        = 57d46515fdd8c2334c77b1f204338bb2178d73e523988d7dcda13259d3a099f31623755d
    msg = append(msg, eadd66b1688d5574)
        = 57d46515fdd8c2334c77b1f204338bb2178d73e523988d7dcda13259d3a099f31623755deadd66b1688d5574
    pendingVerify(msg, https://alice.btc.calendar.opentimestamps.org/)
 -> msg = append(msg, a3ad701ef9f10535a84968b5a99d8580)
        = 679a59f6661f9d809d6f72d2cc080a20435c5c793ace1961ca78e38693f2f53da3ad701ef9f10535a84968b5a99d8580
    msg = sha256(msg)
        = 76e9ac3b3b57c1584828ea5162979c96483a03c87c69a1b8614d1cbaf387e0f5
    msg = prepend(msg, 57d46516)
        = 57d4651676e9ac3b3b57c1584828ea5162979c96483a03c87c69a1b8614d1cbaf387e0f5
    msg = append(msg, 647b90ea1b270a97)
        = 57d4651676e9ac3b3b57c1584828ea5162979c96483a03c87c69a1b8614d1cbaf387e0f5647b90ea1b270a97
    pendingVerify(msg, https://bob.btc.calendar.opentimestamps.org/)`;

const unknownNotary: Uint8Array = uint8ArrayFromBase64(
  `AE9wZW5UaW1lc3RhbXBzAABQcm9vZgC/ieLohOiSlAEI3MIdHR9CpDaioH/JFd7ATbQbg8iYhFlIw9ZktmYPT5HwEF3ewMmaoL/ncAkGFX3XZbsI8BCevS1d31iE2elX6k4fdG/qCPEEV+idKPAI/SjWICYzGFwAAQIDBAUGBwgueHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eA==`,
);
const unknownNotaryInfo: string = `# version: 1
msg = sha256(FILE)
    = dcc21d1d1f42a436a2a07fc915dec04db41b83c898845948c3d664b6660f4f91
msg = append(msg, 5ddec0c99aa0bfe7700906157dd765bb)
    = dcc21d1d1f42a436a2a07fc915dec04db41b83c898845948c3d664b6660f4f915ddec0c99aa0bfe7700906157dd765bb
msg = sha256(msg)
    = 296411802184cab5aba102cd88ff503b4faa54d1b6aa6af1cc6fd59e1dd0d18a
msg = append(msg, 9ebd2d5ddf5884d9e957ea4e1f746fea)
    = 296411802184cab5aba102cd88ff503b4faa54d1b6aa6af1cc6fd59e1dd0d18a9ebd2d5ddf5884d9e957ea4e1f746fea
msg = sha256(msg)
    = 6d747eb37844e2f7a3e47f883487015a068004e8763af2e68e22f5bc558c3b72
msg = prepend(msg, 57e89d28)
    = 57e89d286d747eb37844e2f7a3e47f883487015a068004e8763af2e68e22f5bc558c3b72
msg = append(msg, fd28d6202633185c)
    = 57e89d286d747eb37844e2f7a3e47f883487015a068004e8763af2e68e22f5bc558c3b72fd28d6202633185c
unknownVerify<0102030405060708>(msg, 78787878787878787878787878787878787878787878787878787878787878787878787878787878787878787878)`;

describe('javascript-opentimestamps', (): void => {
  it.each([
    {
      input: badStamp,
      expected: badStampInfo,
      name: 'Bad stamp',
    },
    {
      input: empty,
      expected: emptyInfo,
      name: 'Empty',
    },
    {
      input: helloWorld,
      expected: helloWorldInfo,
      name: 'Hello World',
    },
    {
      input: incomplete,
      expected: incompleteInfo,
      name: 'Incomplete',
    },
    {
      input: knownAndUnknownNotary,
      expected: knownAndUnknownNotaryInfo,
      name: 'Known and Unknown Notary',
    },
    {
      input: merkle1,
      expected: merkle1Info,
      name: 'Merkle 1/3',
    },
    {
      input: merkle2,
      expected: merkle2Info,
      name: 'Merkle 2/3',
    },
    {
      input: merkle3,
      expected: merkle3Info,
      name: 'Merkle 3/3',
    },
    {
      input: twoCalendars,
      expected: twoCalendarsInfo,
      name: 'Two Calendars',
    },
    {
      input: unknownNotary,
      expected: unknownNotaryInfo,
      name: 'Unknown Notary',
    },
  ])('$name', ({ input, expected }: { input: Uint8Array; expected: string }): void => {
    expect(info(read(input), true)).toStrictEqual(expected);
  });
});
